---
layout: article
title: "[ML]3Layer Neural Network"
key: 20180626
tags:
  - Dev
  - ML
  - Neural
  - Python
toc: true
mathjax: true
mathjax_autoNumber: true
---

# [+] Three Layer Neural Network

<!--more-->

## [+] Matrix

### Matrix

ë¨¼ì € íŒŒì´ì¬ìœ¼ë¡œ ë‹¤ì°¨ì› ë°°ì—´ì„ í†µí•´ í–‰ë ¬ì˜ ë‚´ì ì„ êµ¬í•˜ëŠ” ë°©ë²•ë“¤ì„ í•™ìŠµí•œë‹¤.

```python
#-*-coding:utf-8-*-
import numpy as np
import matplotlib.pylab as plt

# ë‹¤ì°¨ì›ë°°ì—´

A = np.array([[1,2],[3,4],[5,6]])
print("Array : \n",A)
print("ì°¨ì› ìˆ˜ : ",np.ndim(A)) #ë°°ì—´ì˜ ì°¨ì› ìˆ˜ í™•ì¸
print("í–‰ë ¬ : ",A.shape) # í–‰ë ¬
```

```
Console
Array :
[[1 2]
[3 4]
[5 6]]
ì°¨ì› ìˆ˜ : 2
í–‰ë ¬ : (3, 2)
```

ê·¸ ì™¸ì— í–‰ë ¬ì˜ ë‚´ì ì„ êµ¬í•˜ê¸° ìœ„í•´ì„œëŠ” np.dot() í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ë©´ ê°„ë‹¨í•˜ê²Œ í–‰ë ¬ì˜ ë‚´ì ì„ êµ¬í•  ìˆ˜ ìˆë‹¤..
í˜•ìƒì´ ë‹¤ë¥¸ í–‰ë ¬ì˜ ë‚´ì ë„ ë§ˆì°¬ê°€ì§€ë¡œ ê³„ì‚°í•  ìˆ˜ ìˆëŠ”ë° ë‚œ ìˆ˜í¬ìì˜€ê¸° ë•Œë¬¸ì— ì—¬ê¸°ì„œ ì‚´ì§ í—·ê°ˆë ¸ì—ˆë‹¤.

í–‰ë ¬ Aì˜ ì²«ë²ˆì§¸ ì°¨ì›ì˜ ì›ì†Œ ìˆ˜(ì—´ì˜ ìˆ˜)ì™€ í–‰ë ¬ Bì˜ 0ë²ˆì§¸ ì°¨ì›ì˜ ì›ì†Œ ìˆ˜(í–‰ ìˆ˜)ê°€ ê°™ì•„ì•¼ ê³„ì‚°ì´ ê°€ëŠ¥í•˜ë‹¤.

```
[1 2 3  	[1 2
 4 5 6] ê³¼ 	3 4]  = Error
```

2x3ì˜ í–‰ë ¬ê³¼ 2x2ì˜ í–‰ë ¬ì˜ ë‚´ì ì€ ì˜¤ë¥˜ë¥¼ ë‚´ë¿œê²Œ ëœë‹¤..
A(3x2) * B(2x4) = C(3x4) ìœ¼ë¡œ ë§Œë“¤ ë•Œ Aì™€ Bì˜ ëŒ€ì‘í•˜ëŠ” ì°¨ì›ì˜ ì›ì†Œ ìˆ˜ê°€ ê°™ì•„ì•¼ í•œë‹¤. í–‰ë ¬ CëŠ” í–‰ë ¬ Aì˜ í–‰ ìˆ˜ì™€ í–‰ë ¬ Bì˜ ì—´ ìˆ˜ê°€ ëœë‹¤. A(**3**x2) * B(2x**4**) = C(**3**x**4**)

ì´ í–‰ë ¬ ë‚´ì ì— ëŒ€í•´ ìµíˆëŠ” ì´ìœ ëŠ” ì•„ì£¼ ì ì€ ì½”ë“œë¡œ ì‹ ê²½ë§ì˜ ìˆœë°©í–¥ ì²˜ë¦¬ë¥¼ ì™„ì„±í•  ìˆ˜ ìˆë‹¤ê³  í•œë‹¤..

## [+] Three Layer Neural Network

### Concept

![3layer](https://github.com/Shhoya/Shhoya.github.io/blob/master/assets/images/task/3layer.png?raw=true "3layer"){:.border}

ìœ„ì˜ ê·¸ë¦¼ì˜ í‘œê¸°ë²•ì„ ì•Œì•„ë‘¬ì•¼ í•œë‹¤.. $$W_{12}^{(1)}$$  ì—¬ê¸°ì„œ í•˜ë‚˜ í•˜ë‚˜ì”© ëœ¯ì–´ ì„¤ëª…í•´ë³¸ë‹¤.
$$(1)$$ = 1ì¸µì˜ ê°€ì¤‘ì¹˜
$$1$$ = ë‹¤ìŒ ì¸µì˜ ì²«ë²ˆì§¸ ë‰´ëŸ°
2 = ì• ì¸µì˜ 2ë²ˆì§¸ ë‰´ëŸ°
ì„ ì˜ë¯¸í•œë‹¤.

í•´ì„í•´ë³´ë©´ ì• ì¸µì˜ 2ë²ˆì§¸ ë‰´ëŸ°($$x_2$$)ì—ì„œ ë‹¤ìŒ ì¸µì˜ ì²«ë²ˆì§¸ ë‰´ëŸ°($$a_{1}^{(1)}$$)ìœ¼ë¡œ í–¥í•  ë•Œì˜ ê°€ì¤‘ì¹˜($$w$$) ë¼ëŠ” ì˜ë¯¸ê°€ ëœë‹¤.
ì¤‘ìš”í•˜ë‹¤ ì•ìœ¼ë¡œ ì‹ ê²½ë§ ê·¸ë¦¼ë§ˆë‹¤ ìš”ê²Œ ë‚˜ì˜¨ë‹¤...

![3layer](https://github.com/Shhoya/Shhoya.github.io/blob/master/assets/images/task/3layer2.png?raw=true "3layer"){:.border}

'1' ì€ í¸í–¥ì„ ì˜ë¯¸í•œë‹¤. í¸í–¥ì€ ì¸ë±ìŠ¤ê°€ í•˜ë‚˜ë°–ì— ì—†ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.($$b_1^{(1)}$$)
$$a_1^{(1)}$$ ë¥¼ ìˆ˜ì‹ìœ¼ë¡œ ë‚˜íƒ€ë‚´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤. ê°€ì¤‘ì¹˜ë¥¼ ê³±í•˜ê³  ì‹ í˜¸ ë‘ê°œì™€ì˜ í¸í–¥ì„ í•©í•´ ê³„ì‚°í•œë‹¤.

$$a_1^{(1)} = w_{11}^{(1)}x_1 + w_{12}^{(1)}x_2 + b_1^{(1)}$$

ì´ê±¸... í–‰ë ¬ì˜ ë‚´ì ì„ ì´ìš©í•˜ë©´ 1ì¸µì˜ ê°€ì¤‘ì¹˜ë¥¼ ê°„ì†Œí™”í•  ìˆ˜ ìˆë‹¤.

$$A^{(1)} = XW^{(1)} + B^{(1)}$$

ì ì „ì²´ì ìœ¼ë¡œ ë³´ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.

$$A^{(1)} = (a_1^{(1)} a_2^{(1)} a_3^{(1)})$$ , $$X = (x_1 x_2)$$ , $$B^{(1)} = (b_1^{(1)} b_2^{(1)} b_3^{(1)})$$ 

$$W^{(1)}$$ = 3x2 í˜•ìƒì˜ í–‰ë ¬.. ìˆ˜ì‹ ì“°ê¸°ê°€ ë¹¡ì„¸ë‹¤ ã… . 

ì„ì˜ì˜ ê°’ì„ ì´ìš©í•´ íŒŒì´ì¬ìœ¼ë¡œ êµ¬í˜„í•´ë³¸ë‹¤. ê·¸ ì „ì— ì´ì „ì— ì¼ë˜ í™œì„±í™” í•¨ìˆ˜ì— ëŒ€í•œ ì¡´ì¬ë¥¼ ìŠì–´ì„  ì•ˆëœë‹¤. í™œì„±í™” í•¨ìˆ˜ë¥¼ ì´ìš©í•´ $$z_1^{(1)}$$ ë¥¼ ë³€í™˜ë˜ëŠ” ê·¸ë¦¼ì€ ì•„ë˜ì™€ ê°™ë‹¤.

![3layer](https://github.com/Shhoya/Shhoya.github.io/blob/master/assets/images/task/3layer3.png?raw=true "3layer"){:.border}

ì´ë¥¼ íŒŒì´ì¬ìœ¼ë¡œ êµ¬í˜„í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ ì½”ë“œë¥¼ ì“¸ ìˆ˜ ìˆë‹¤.

```python
#-*-coding:utf-8-*-
import numpy as np

def step_func(x):
    return np.array(x >0,dtype=np.int)


def sigmoid(x):
    return 1 / (1+np.exp(-x))

X = np.array([1.0, 0.5]) #ì…ë ¥ ì‹ í˜¸
W1 = np.array([[0.1, 0.3, 0.5],[0.2, 0.4, 0.6]]) #ê°€ì¤‘ì¹˜
B1 = np.array([0.1, 0.2, 0.3]) #í¸í–¥

print(W1.shape)
print(X.shape)
print(B1.shape)

A1 = np.dot(X,W1)+B1 #í–‰ë ¬ì˜ ë‚´ì  + í¸í–¥
print(A1)
Z1 = sigmoid(A1) #í™œì„±í™” í•¨ìˆ˜ë¥¼ ì´ìš©í•´ ì‹ í˜¸ ë³€í™˜
print(Z1)

```

```
Console
(2, 3)
(2,)
(3,)
[0.3 0.7 1.1]
[0.57444252 0.66818777 0.75026011]
```

ì—¬ê¸°ì„œ ë‚˜ëŠ” ê¹¨ë‹¬ìŒì„ ì–»ì—ˆëœ¨ì•„.
í™œì„±í™” í•¨ìˆ˜ë¥¼ ê³„ë‹¨í•¨ìˆ˜ë¥¼ ì¨ë³´ë©´ 0ë³´ë‹¤ í° ê°’ì´ ë‚˜ì˜¤ê¸° ë•Œë¬¸ì— ë¬´ì¡°ê±´ '1'ì„ ì¶œë ¥í•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.
ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë‹ˆ ê·¸ ê°’ì´ ë§¤ìš° ì„¬ì„¸í•œ(?) ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.

ìš”ì¦˜ ê´€ì‹¬ì„ ê°–ê³  ê³µë¶€ë¥¼ í•˜ë‹ˆ ì¢€ ë” ë­”ê°€ ë³´ì´ëŠ”ê²Œ ë§ì•„ì§„ë‹¤. ì¢‹ë‹¤.

ì´ ì •ë„ ê¹¨ë‹¬ìŒì´ë©´ ì˜¤ëŠ˜ì€ ì—¬ê¸°ê¹Œì§€.ğŸ‘»

## [+] Reference

1. <a href="http://www.hanbit.co.kr/store/books/look.php?p_code=B8475831198">*"ë°‘ë°”ë‹¥ë¶€í„° ì‹œì‘í•˜ëŠ” ë”¥ëŸ¬ë‹"*</a>
2. <a href="https://en.wikipedia.org/wiki/Artificial_neural_network">*"Wikipedia_Neural_Network"*</a>